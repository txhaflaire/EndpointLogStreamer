# EndpointLogStreamer

![](https://img.shields.io/github/v/release/txhaflaire/EndpointLogStreamer)&nbsp;![](https://img.shields.io/github/downloads/txhaflaire/EndpointLogStreamer/latest/total)&nbsp;![](https://img.shields.io/badge/macOS-10.13%2B-success)&nbsp;![](https://img.shields.io/github/license/txhaflaire/EndpointLogStreamer)

A native code-signed and notarized macOS Swift binary that allows to monitor one or multiple log files and stream new entries to an **HTTP Collection Endpoint** or **Microsoft Log Analytics Workspace** in an way system performance is respected.


> [!NOTE]  
> The current release is a 0. release and is still under development

You will find the latest release in the [releases](https://github.com/txhaflaire/EndpointLogStreamer/releases) section.


##### Configuration

As with many tools, also EndpointLogStreamer does require a minimal configuration in order to function.

Provided in this repository you will find an Jamf Pro JSON Schema for EndpointLogStreamer to easily configure it within Jamf Pro, alternatively you will also find an example plist which can be used as baseline as well.

To find out more about managing **EndpointLogStreamer** please refer to the Wiki on this GitHub repository.


##### Persistence

To ensure EndpointLogStreamer automatically runs after installation, a LaunchDaemon is included in the installer and up on load it will execute the EndpointLogStreamer binary.

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>Label</key>
	<string>com.txhaflaire.els</string>
	<key>Program</key>
	<string>/usr/local/bin/EndpointLogStreamer</string>
	<key>RunAtLoad</key>
	<true/>
</dict>
</plist>
```

##### Logging

In order to troubleshoot we need logs, EndpointLogStreamer does write extensively to the Unified Logging subsystem.
To review logs that are generated by EndpointLogStreamer you could start by running either one of the following commands.


*Log Show*
```
log show --predicate 'subsystem == "com.txhaflaire.els"' --info
```

*Log Stream*
```
log stream --predicate 'subsystem == "com.txhaflaire.els"' --info --last 2h
```

*Output*
```
2023-08-29 18:53:56.538 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:configuration] Configuration: HTTP Log Forwarder is enabled..
2023-08-29 18:53:56.538 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:configuration] Configuration: HTTP URL is set..
2023-08-29 18:53:56.538 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:configuration] Configuration: Log Analytics Forwarder is enabled..
2023-08-29 18:53:56.538 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:configuration] Configuration: The customerID is set.
2023-08-29 18:53:56.538 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:configuration] Configuration: The sharedKey is set.
2023-08-29 18:53:56.538 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:configuration] Configuration: Monitoring Log File - <private>
2023-08-29 18:53:56.540 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:configuration] Configuration: Monitoring Log File - <private>
2023-08-29 18:55:19.085 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:binary] Buffer Flush Check: Exceeded interval of 20.000000 seconds
2023-08-29 18:55:19.095 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:binary] Buffer Flush State: Flushed - <private>
2023-08-29 18:55:19.633 I  EndpointLogStreamer[84430:1693b9] [com.txhaflaire.els:sentinel] Sentinel: succesfully send log data to Analytics Workspace - 200
2023-08-29 18:55:20.360 I  EndpointLogStreamer[84430:1693b7] [com.txhaflaire.els:http] HTTP: Successfully sent log data to URL
2023-08-29 18:55:21.998 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:binary] Buffer Flush Check: Buffer Size: 71, Max Buffer Size: 5000
2023-08-29 18:55:21.998 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:binary] Buffer Flush State: Pending
2023-08-29 18:55:23.236 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:binary] Buffer Flush Check: Buffer Size: 148, Max Buffer Size: 5000
2023-08-29 18:55:23.236 I  EndpointLogStreamer[84430:168bca] [com.txhaflaire.els:binary] Buffer Flush State: Pending
```

#### Sample Screenshots

*Microsoft Log Analytics Workspace*
<img width="1027" alt="LogAnalyticsLight" src="./Images/LogAnalyticsLight.png">

*Splunk Enterprise*
<img width="1027" alt="SplunkEnterpriseLight" src="./Images/SplunkEnterpriseLight.png">